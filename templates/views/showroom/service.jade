extends ../../layouts/default-showroom
//- Use the Showroom Default Template

mixin industryDropdown(options, industry, service)

	.dropdown.custom-dropdown
		button(type="button" id="dropdownMenu1" data-toggle="dropdown" aria-expanded="true").btn.btn-default.dropdown-toggle
			.icon-arrow
				img(src="/images/arrow_down.png")
			span.custom-dropdown-current for 
				= industry
		ul.dropdown-menu(role="menu" aria-labelledby="dropdwonMenu1")
			li(role="presentation")
				a(role="menuitem" tabindex="-1" href=linkURI("/services/"+service.slug+"/")) All
			each option in options
				li(role="presentation")
					a(role="menuitem" tabindex="-1" href=linkURI("/services/"+service.slug+"/"+option.slug))= option.title


mixin product(product)
	.row
		.col-xs-10.col-xs-offset-1.col-lg-12.col-lg-offset-0
			h2.product-title.can-favorite.solution-page-title(data-solutions-slug=product.slug data-solutions-type='products')= product.title
				.coxicon.coxicon_favorites_star_after
		.col-xs-10.col-xs-offset-1
			
			if product.video.video_choice
				if product.video.video.url
					a(data-toggle="modal" data-target="#video_modal" data-video-data=product.video style= product.video.background.url ? "background-image: url(" + product.video.background.url+");" : "").video-link.product-hero-container						
						img(src="/icons/png/icon-play.png").product-play-icon
						if product.video.title_overlay
							h2.product-video-title= product.title
				else
					a(style= product.video.background.url ? "background-image: url(" + product.video.background.url+");" : "").product-hero-container
						if product.video.title_overlay
							h2.product-video-title= product.title			
			else
				a(style= product.video.background.url ? "background-image: url(" + product.video.background.url+");" : "").product-hero-container
					if product.video.title_overlay
						h2.product-video-title= product.title
			.overflow-wrapper
			section.product-item-container
				span.product-fade-bottom
				.product-showroom-scroll
					img(src="/images/arrow_down.png")
				.row
					.col-xs-2.product-icon-container
						.product-item-icon.coxicon(class="coxicon_"+product.item_one.svg_icon)
					.col-xs-9.col-lg-7
						p.section-heading= product.item_one.title
						p.section-content= product.item_one.content
				.row
					.col-xs-2.product-icon-container
						.product-item-icon.coxicon(class="coxicon_"+product.item_two.svg_icon)
					.col-xs-9.col-lg-7
						p.section-heading= product.item_two.title
						p.section-content= product.item_two.content
				.row
					.col-xs-2.product-icon-container
						.product-item-icon.coxicon(class="coxicon_"+product.item_three.svg_icon)
					.col-xs-9.col-lg-7
						p.section-heading= product.item_three.title
						p.section-content= product.item_three.content
				.row
					.col-xs-2.product-icon-container
						.product-item-icon.coxicon(class="coxicon_"+product.item_four.svg_icon)
					.col-xs-9.col-lg-7
						p.section-heading= product.item_four.title
						p.section-content= product.item_four.content
				.row
					.col-xs-2.product-icon-container
						.product-item-icon.coxicon(class="coxicon_"+product.item_five.svg_icon)
					.col-xs-9.col-lg-7
						p.section-heading= product.item_five.title
						p.section-content= product.item_five.content
			

block content

	//- Check the Service exists
	if !data.service
		h2 Service Invalid Post.
	else
		.row
			.col-xs-6.full-height-col.service-container
				span.background-shadow.from-left
				.row.header-space
				.row
					.col-xs-10.col-lg-8.col-xs-offset-1.content-container
						h1.service-title.can-favorite.solution-page-title(data-solutions-slug=data.service.slug data-solutions-type='services')= data.service.title
							.coxicon.coxicon_favorites_star_after
						section
							- var current = 0
							each industry in data.service.industries
								if data.industry == industry.slug
									- current = industry.title

							if current
								.services-current-industry for #{current}
								//- +industryDropdown(data.service.industries, current, data.service)
							else
								.services-current-industry for All Industries
								//- +industryDropdown(data.service.industries, 'All Industries', data.service)

						p.section-heading= data.service.heading
						p.section-content= data.service.content
					.col-xs-10.col-xs-offset-1
						if !data.products
							h2 No Products!
						else
							.col-xs-6.col-lg-4.product-navigation-title-container
								article.product-navigation-title
									span PRODUCTS

							//- Loops thru all Products
							- var activeSwitch = 0
							each product, index in data.products
								- var currentIndustry = 0
								each industry in data.service.industries
									if data.industry == industry.slug
										- currentIndustry = industry
								if currentIndustry
									each productIndustry in product.industries
										if productIndustry == currentIndustry.id
											if !activeSwitch
												.col-xs-6.col-lg-4.product-navigation-item-container(data-navigationitem=product.id).active
													article.product-navigation-item
														span= product.title
												- activeSwitch = true;
											else
												.col-xs-6.col-lg-4.product-navigation-item-container(data-navigationitem=product.id)
													article.product-navigation-item
														span= product.title
									
								else
									.col-xs-6.col-lg-4.product-navigation-item-container(data-navigationitem=product.id class=(index == 0 ? 'active' : null))
										article.product-navigation-item
											span= product.title

			.col-xs-6.full-height-col
				span.background-shadow.from-right
				span.product-gradient: span
				if !data.products
					h2 No Products!
				else
					- var activeSwitch = 0
					each product, index in data.products
						- var currentIndustry = 0
						each industry in data.service.industries
							if data.industry == industry.slug
								- currentIndustry = industry
						if currentIndustry
							each productIndustry in product.industries
								if productIndustry == currentIndustry.id
									if !activeSwitch
										.col-xs-12.full-height-col.product-container(data-item=product.id).active
											+product(product)
										- activeSwitch = true;
									else
										.col-xs-12.full-height-col.product-container(data-item=product.id)
											+product(product)
							
						else
							.col-xs-12.full-height-col.product-container(data-item=product.id class=(index == 0 ? 'active' : null))
								+product(product)
